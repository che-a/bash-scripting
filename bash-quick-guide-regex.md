## Регулярные выражения
Регулярные выражения (regular expressions, сокр. regex) — это шаблоны, созданные с использованием последовательности символов и метасимволов.
### grep
`grep` — это команда, которая выполняет поиск по содержимому файлов с помощью заданного шаблона и выводит любую строку, которая ему соответствует.
#### Общие параметры grep
`-c` — вывести количество строк, соответствующих шаблону;  
`-E` — включить расширенное регулярное выражение;  
`-f` — читать шаблон поиска, находящийся в предоставленном файле. Файл может содержать несколько шаблонов, причем каждая строка включает в себя один шаблон;  
`-i` — игнорировать регистр символов;  
`-l` — вывести только имя файла и путь, по которому был найден шаблон;  
`-n` — вывести номер строки файла, в которой был найден шаблон;  
`-P` — включить механизм регулярных выражений Perl;  
`-R` , `-r` — выполнить рекурсивный поиск подкаталого.  
```sh
# Общий случай использования
grep <параметры> <шаблон> <имена_файлов>

# Поиск строк в каталоге /home и во всех его подкаталогах файлов, содержащих слово password независимо от регистра
grep -R -i 'password' /home

# Найти строку в файле 
grep "<строка>" <файл>

# Посчитать количество вхождений строки
grep -с "<строка>" <файл>

# Найти строку во всех файлах в папке
grep -r "<строка>" <папка>

# Найти слово hello в файле file.txt
grep "hello" file.txt

# Вывести количество раз, которое "123" встречается в file.txt
grep -с "123" file.txt

# Найти слово "world" во всех файлах в домашней директории
grep -r "world" ~/
```
```sh
# Ограничиться поиском строк в файле количеством вхождений
grep -m <число_вхождений> "<строка>" <файл>

# Выводить число строк после вхождения
grep -A <число> "<строка>" <файл>

# Выводить число строк до вхождения
grep -B <число> "<строка>" <файл>

# Выводить число строк вокруг вхождения
grep -C <число> "<строка>" <файл>


grep -E “c[au]t” <файл>
# найти все слова, содержащие cut и cat
grep -E “ [a-z]ight ” <файл>
# слова из 5 букв, кончающиеся на “ight”
grep -E “ [a-z]*ight ” <файл>
# слова из 4 и более букв, кончающиеся на “ight”
grep -E “ [a-z]+ight ” <файл>
# слова из 5 и более букв, кончающиеся на “ight”
grep -E “ [a-z]?ight ” <файл>
# слова из 4-5 букв, кончающиеся на “ight”
grep -E “ [a-zA-Z]*ight ” <файл>
# слова, кончающиеся на “ight” (разрешены большие бук
```

#### Расширенный синтаксис для шаблонов регулярных выражений
Единственные символы, на которые влияет расширенный синтаксис, — это `+` , `{` , `|` , `(` и `)`.  
Способы использования расширенного синтаксиса:
- добавить перед этими символами обратный слеш `\`;  
- вызвать `grep -E`;  
- добавить команду `egrep`, которая представляет собой скрипт, вызывающий `grep` как `grep -E`.  

#### Метасимволы
`.` соответствует любому символу, кроме символа новой строки.  
`?` делает любой предшествующий ему символ необязательным.  
`*` соответствует предыдущему элементу неограниченное количество раз.  
`+` соответствует предыдущему элементу, который должен встретиться хотя бы однажды.  
`()` символы, расположенные внутри скобок, рассматриваются как один элемент.  
`|` логический оператор ИЛИ.  
`[]` предназначены для определения классов и списков допустимых символов.  
```sh
# Тестовый файл frost.txt для примеров.
1    Two roads diverged in a yellow wood,
2    And sorry I could not travel both
3    And be one traveler, long I stood
4    And looked down one as far as I could
5    To where it bent in the undergrowth;
6
7 Excerpt from The Road Not Taken by Robert Frost
```
```sh
grep 'T.o' frost.txt
# 1    Two roads diverged in a yellow wood,

grep 'T.\?o' frost.txt
grep -E 'T.?o' frost.txt
egrep 'T.?o' frost.txt 
# 1    Two roads diverged in a yellow wood,
# 5    To where it bent in the undergrowth;

grep 'T.*o' frost.txt
# 1    Two roads diverged in a yellow wood,
# 5    To where it bent in the undergrowth;
# 7 Excerpt from The Road Not Taken by Robert Frost

egrep 'T.+o' frost.txt
# 1    Two roads diverged in a yellow wood,
# 5    To where it bent in the undergrowth;
# 7 Excerpt from The Road Not Taken by Robert Frost

egrep 'And be one (stranger|traveler), long I stood' frost.txt
# 3    And be one traveler, long I stood
```
#### Классы символов
- `[abc]` Соответствует только символу a, или b, или c.  
- `[1–5]` Соответствует цифрам в диапазоне от 1 до 5.  
- `[a–zA–Z]` Соответствует любой строчной или прописной букве от a до z.  
- `[0–9 +–*/]` Соответствует числам или указанным четырем математическим символам.  
- `[0–9a–fA–F]` Соответствует шестнадцатеричному символу.   
- `[1–475]` соответствует любой из цифр (символов) в диапазоне 1–4, или символу 7, или символу 5.  

#### Символьные классы регулярных выражений в скобках
`[:alnum:]` Любой буквенно-цифровой символ  
`[:alpha:]` Любой алфавитный символ  
`[:cntrl:]` Любой управляющий символ  
`[:digit:]` Любая цифра  
`[:graph:]` Любой графический символ  
`[:lower:]` Любой символ нижнего регистра  
`[:print:]` Любой печатаемый символ  
`[:punct:]` Любой знак препинания  
`[:space:]` Любой пробельный символ  
`[:upper:]` Любой символ верхнего регистра  
`[:xdigit:]` Любая шестнадцатеричная цифра  

```sh
# Вывод строк, в которых есть символ `X`, за которым следует любая прописная буква или цифра
grep 'X[[:upper:][:digit:]]' idlist.txt
```
#### Обратные ссылки
Символ `\1` относится к первому набору квадратных скобок, `\2` — ко второму и т. д.  
```html
# Содержимое файла tags.txt
1    Command
2    <i>line</i>
3    is
4    <div>great</div>
5    <u>!</u>
```
```sh
# Извлечение строк, содержащих соответствующую пару полных тегов HTML
egrep '<([A-Za-z]*)>.*</\1>' tags.txt
# Результат:
# 2    <i>line</i>
# 4    <div>great</div>
# 5    <u>!</u>
```
- `([0-9]+).*=.*\1` — шаблон для поиска строк, в которых числа, находящиеся по обе стороны от знака равенства, соответствовали друг другу. Например, «314 is = to 314» — это правильно, а «6 = 7» — это неправильно.  
- `10\.0\.0\.(25|134)` — поиск IP-адресов 10.0.0.25 или 10.0.0.134.  

#### Квантификаторы
`{}` — квантификаторы указывают сколько раз элемент должен последовательно появиться в строке.  
- `T{5}` — буква T должна последовательно появляться ровно пять раз.  
- `T{3,6}` — буква T должна последовательно появляться  от трех до шести раз.  
- `T{5,}` — буква T должна последовательно появляться пять раз или более.

#### Якоря и границы слов
- `^` — привязка шаблона к началу строки. Например, `^[1-5]` означает, что соответствующая строка должна начинаться с одной из цифр от 1 до 5.  
- `$` — привязка шаблона к концу последовательности или строки. Например, `[1-5]$` означает, что строка должна заканчиваться одной из цифр от 1 до 5.  
- `\b` — используется для определения границы слова (то есть обозначить пробел). Шаблон `\b[1-5]\b` будет соответствовать любой из цифр от 1 до 5,
где цифра представлена словом.  
```sh
# найти строки, начинающиеся с go
grep -E "^go" <файл>

# найти строки, оканчивающиеся на go
grep -E "go$" <файл>
```
